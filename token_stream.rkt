#lang racket

;; Generated code for Delta module 'token_stream' 

(require delta/runtime)
(require delta/standard)
(require delta/io)
(require "location.rkt")
(require "config.rkt")

(provide d_open_token_stream d_close_token_stream d_next_token d_peek_token d_token_stream_eof d_token_kind d_token_value d_token_range d_read_kinded_token d_skip_token)

(define d_make_token_stream (lambda (l_p514 l_d515 l_l516 l_handle l_file) (let ((l_s513 (state (quote l_handle) l_handle (quote l_file) l_file))) (let ((l_s517 (merge-state l_s513 (let ((l_s518 (singleton-state (quote l_cell) (d_make_array 1)))) (let ((l_s519 (merge-state l_s513 l_s518))) (let ((l_s520 l_s518)) (let ((l_s527 (singleton-state (quote l_stream) (d_tuple (lookup (quote l_handle) l_s519) (lookup (quote l_cell) l_s519) (lookup (quote l_file) l_s519))))) (let ((l_s528 (merge-state l_s519 l_s527))) (let ((l_s529 (merge-state (or l_s520 (empty-state)) l_s527))) (merge-state (or l_s529 (empty-state)) (d_set (lookup (quote l_cell) l_s528) 0 (d_read_token #f #f #f (lookup (quote l_stream) l_s528))))))))))))) (let ((l_t552 (let ((l_t553 (lookup (quote l_stream) l_s517))) (let ((l_p554 l_p514)) (if l_p554 (merge-state l_p554 (if l_d515 (empty-state) l_t553)) (if l_d515 (empty-state) l_t553)))))) (if l_l516 (leave-collective l_l516 l_t552) l_t552))))))

(define d_token_stream_handle (lambda (l_p558 l_d559 l_l560 l_stream) (let ((l_s557 (state (quote l_stream) l_stream))) (d_apply l_p558 l_d559 l_l560 (lambda (l_p562 l_d563 l_l564 l_a l_b l_c) (let ((l_s561 (merge-state l_s557 (state (quote l_a) l_a (quote l_b) l_b (quote l_c) l_c)))) (let ((l_t565 (let ((l_t566 (lookup (quote l_a) l_s561))) (let ((l_p567 l_p562)) (if l_p567 (merge-state l_p567 (if l_d563 (empty-state) l_t566)) (if l_d563 (empty-state) l_t566)))))) (if l_l564 (leave-collective l_l564 l_t565) l_t565)))) (lookup (quote l_stream) l_s557)))))

(define d_token_stream_token_cell (lambda (l_p573 l_d574 l_l2632 l_stream) (let ((l_s572 (state (quote l_stream) l_stream))) (d_apply l_p573 l_d574 l_l2632 (lambda (l_p2634 l_d2635 l_l2636 l_a l_b l_c) (let ((l_s2633 (merge-state l_s572 (state (quote l_a) l_a (quote l_b) l_b (quote l_c) l_c)))) (let ((l_t2637 (let ((l_t2638 (lookup (quote l_b) l_s2633))) (let ((l_p2639 l_p2634)) (if l_p2639 (merge-state l_p2639 (if l_d2635 (empty-state) l_t2638)) (if l_d2635 (empty-state) l_t2638)))))) (if l_l2636 (leave-collective l_l2636 l_t2637) l_t2637)))) (lookup (quote l_stream) l_s572)))))

(define d_token_stream_file (lambda (l_p2645 l_d2646 l_l2647 l_stream) (let ((l_s2644 (state (quote l_stream) l_stream))) (d_apply l_p2645 l_d2646 l_l2647 (lambda (l_p2649 l_d2650 l_l2651 l_a l_b l_c) (let ((l_s2648 (merge-state l_s2644 (state (quote l_a) l_a (quote l_b) l_b (quote l_c) l_c)))) (let ((l_t2652 (let ((l_t2653 (lookup (quote l_c) l_s2648))) (let ((l_p2654 l_p2649)) (if l_p2654 (merge-state l_p2654 (if l_d2650 (empty-state) l_t2653)) (if l_d2650 (empty-state) l_t2653)))))) (if l_l2651 (leave-collective l_l2651 l_t2652) l_t2652)))) (lookup (quote l_stream) l_s2644)))))

(define d_open_token_stream (lambda (l_p2660 l_d2661 l_l2662 l_name) (let ((l_s2659 (state (quote l_name) l_name))) (d_make_token_stream l_p2660 l_d2661 l_l2662 (d_open_input_file (lookup (quote l_name) l_s2659)) (lookup (quote l_name) l_s2659)))))

(define d_close_token_stream (lambda (l_p2672 l_d2673 l_l2674 l_stream) (let ((l_s2671 (state (quote l_stream) l_stream))) (let ((l_t2677 (let ((l_t2678 (d_close_file (d_token_stream_handle #f #f #f (lookup (quote l_stream) l_s2671))))) (or l_p2672 (empty-state))))) (if l_l2674 (leave-collective l_l2674 l_t2677) l_t2677)))))

(define d_next_token (lambda (l_p2683 l_d2684 l_l2685 l_stream) (let ((l_s2682 (state (quote l_stream) l_stream))) (let ((l_s2686 (merge-state l_s2682 (let ((l_s2687 (singleton-state (quote l_cell) (d_token_stream_token_cell #f #f #f (lookup (quote l_stream) l_s2682))))) (let ((l_s2688 (merge-state l_s2682 l_s2687))) (let ((l_s2689 l_s2687)) (let ((l_s2694 (singleton-state (quote l_token) (d_get (lookup (quote l_cell) l_s2688) 0)))) (let ((l_s2695 (merge-state l_s2688 l_s2694))) (let ((l_s2696 (merge-state (or l_s2689 (empty-state)) l_s2694))) (merge-state (or l_s2696 (empty-state)) (d_set (lookup (quote l_cell) l_s2695) 0 (d_read_token #f #f #f (lookup (quote l_stream) l_s2695))))))))))))) (let ((l_t2717 (let ((l_t2718 (lookup (quote l_token) l_s2686))) (let ((l_p2719 l_p2683)) (if l_p2719 (merge-state l_p2719 (if l_d2684 (empty-state) l_t2718)) (if l_d2684 (empty-state) l_t2718)))))) (if l_l2685 (leave-collective l_l2685 l_t2717) l_t2717))))))

(define d_peek_token (lambda (l_p2723 l_d2724 l_l2725 l_stream) (let ((l_s2722 (state (quote l_stream) l_stream))) (let ((l_t2730 (let ((l_t2731 (d_get (d_token_stream_token_cell #f #f #f (lookup (quote l_stream) l_s2722)) 0))) (let ((l_p2732 l_p2723)) (if l_p2732 (merge-state l_p2732 (if l_d2724 (empty-state) l_t2731)) (if l_d2724 (empty-state) l_t2731)))))) (if l_l2725 (leave-collective l_l2725 l_t2730) l_t2730)))))

(define d_token_stream_eof (lambda (l_p2736 l_d2737 l_l2738 l_stream) (let ((l_s2735 (state (quote l_stream) l_stream))) (let ((l_t2743 (let ((l_t2744 (equal? (d_token_kind #f #f #f (d_peek_token #f #f #f (lookup (quote l_stream) l_s2735))) "end"))) (let ((l_p2745 l_p2736)) (if l_p2745 (merge-state l_p2745 (if l_d2737 (empty-state) l_t2744)) (if l_d2737 (empty-state) l_t2744)))))) (if l_l2738 (leave-collective l_l2738 l_t2743) l_t2743)))))

(define d_stream_location (lambda (l_p2749 l_d2750 l_l2751 l_stream) (let ((l_s2748 (state (quote l_stream) l_stream))) (d_apply l_p2749 l_d2750 l_l2751 (lambda (l_p2753 l_d2754 l_l2755 l_x l_y l_z) (let ((l_s2752 (merge-state l_s2748 (state (quote l_x) l_x (quote l_y) l_y (quote l_z) l_z)))) (d_make_location l_p2753 l_d2754 l_l2755 (d_token_stream_file #f #f #f (lookup (quote l_stream) l_s2752)) (lookup (quote l_x) l_s2752) (lookup (quote l_y) l_s2752) (lookup (quote l_z) l_s2752)))) (d_file_position (d_token_stream_handle #f #f #f (lookup (quote l_stream) l_s2748)))))))

(define d_read_token (lambda (l_p4028 l_d4029 l_l4030 l_stream) (let ((l_s4027 (state (quote l_stream) l_stream))) (let ((l_s4031 (merge-state l_s4027 (let ((l_s4032 (singleton-state (quote l_handle) (d_token_stream_handle #f #f #f (lookup (quote l_stream) l_s4027))))) (let ((l_s4033 (merge-state l_s4027 l_s4032))) (let ((l_s4034 l_s4032)) (let ((l_s4039 (singleton-state (quote l_next) (d_peek_next_char #f #f #f (lookup (quote l_handle) l_s4033))))) (let ((l_s4040 (merge-state l_s4033 l_s4039))) (let ((l_s4041 (merge-state (or l_s4034 (empty-state)) l_s4039))) (merge-state (or l_s4041 (empty-state)) (singleton-state (quote l_start) (d_stream_location #f #f #f (lookup (quote l_stream) l_s4040))))))))))))) (let ((l_s4054 (if (equal? (lookup (quote l_next) l_s4031) eof) (let ((l_s4063 (singleton-state (quote l_kind) "end"))) (let ((l_s4064 (merge-state l_s4031 l_s4063))) (let ((l_s4065 l_s4063)) (merge-state (or l_s4065 (empty-state)) (singleton-state (quote l_value) "end"))))) (if (d_numeric (lookup (quote l_next) l_s4031)) (let ((l_s4080 (singleton-state (quote l_kind) "number"))) (let ((l_s4081 (merge-state l_s4031 l_s4080))) (let ((l_s4082 l_s4080)) (merge-state (or l_s4082 (empty-state)) (singleton-state (quote l_value) (d_read_number_token #f #f #f (lookup (quote l_stream) l_s4081))))))) (if (equal? (lookup (quote l_next) l_s4031) #\") (let ((l_s4099 (singleton-state (quote l_kind) "string_literal"))) (let ((l_s4100 (merge-state l_s4031 l_s4099))) (let ((l_s4101 l_s4099)) (merge-state (or l_s4101 (empty-state)) (singleton-state (quote l_value) (d_read_string_token #f #f #f (lookup (quote l_stream) l_s4100))))))) (if (equal? (lookup (quote l_next) l_s4031) #\\) (let ((l_s4118 (singleton-state (quote l_kind) "character_literal"))) (let ((l_s4119 (merge-state l_s4031 l_s4118))) (let ((l_s4120 l_s4118)) (merge-state (or l_s4120 (empty-state)) (singleton-state (quote l_value) (d_read_character_token #f #f #f (lookup (quote l_stream) l_s4119))))))) (if (if (equal? (lookup (quote l_next) l_s4031) #\_) #t (d_alphabetic (lookup (quote l_next) l_s4031))) (let ((l_s4143 (merge-state l_s4031 (singleton-state (quote l_id) (d_read_identifier_token #f #f #f (lookup (quote l_stream) l_s4031)))))) (if (equal? (lookup (quote l_id) l_s4143) "true") (let ((l_s4154 (singleton-state (quote l_kind) "Boole"))) (let ((l_s4155 (merge-state l_s4143 l_s4154))) (let ((l_s4156 l_s4154)) (merge-state (or l_s4156 (empty-state)) (singleton-state (quote l_value) "true"))))) (if (equal? (lookup (quote l_id) l_s4143) "false") (let ((l_s4173 (singleton-state (quote l_kind) "Boole"))) (let ((l_s4174 (merge-state l_s4143 l_s4173))) (let ((l_s4175 l_s4173)) (merge-state (or l_s4175 (empty-state)) (singleton-state (quote l_value) "false"))))) (if (equal? (lookup (quote l_id) l_s4143) "and") (let ((l_s4192 (singleton-state (quote l_kind) "operator"))) (let ((l_s4193 (merge-state l_s4143 l_s4192))) (let ((l_s4194 l_s4192)) (merge-state (or l_s4194 (empty-state)) (singleton-state (quote l_value) "and"))))) (if (equal? (lookup (quote l_id) l_s4143) "or") (let ((l_s4211 (singleton-state (quote l_kind) "operator"))) (let ((l_s4212 (merge-state l_s4143 l_s4211))) (let ((l_s4213 l_s4211)) (merge-state (or l_s4213 (empty-state)) (singleton-state (quote l_value) "or"))))) (let ((l_s4224 (singleton-state (quote l_kind) "identifier"))) (let ((l_s4225 (merge-state l_s4143 l_s4224))) (let ((l_s4226 l_s4224)) (merge-state (or l_s4226 (empty-state)) (singleton-state (quote l_value) (lookup (quote l_id) l_s4225))))))))))) (if (d_is_operator_character #f #f #f (lookup (quote l_next) l_s4031)) (let ((l_s4239 (singleton-state (quote l_kind) "operator"))) (let ((l_s4240 (merge-state l_s4031 l_s4239))) (let ((l_s4241 l_s4239)) (merge-state (or l_s4241 (empty-state)) (singleton-state (quote l_value) (d_read_operator_token #f #f #f (lookup (quote l_stream) l_s4240))))))) (let ((l_s4252 (singleton-state (quote l_value) (d_next_char #f #f #f (lookup (quote l_handle) l_s4031))))) (let ((l_s4253 (merge-state l_s4031 l_s4252))) (let ((l_s4254 l_s4252)) (merge-state (or l_s4254 (empty-state)) (singleton-state (quote l_kind) "character"))))))))))))) (let ((l_s4055 (merge-state l_s4031 l_s4054))) (let ((l_s4056 (let ((l_t4272 l_s4054)) (let ((l_p4273 l_p4028)) (if l_p4273 (merge-state l_p4273 (if l_d4029 (empty-state) l_t4272)) (if l_d4029 (empty-state) l_t4272)))))) (let ((l_t4269 (let ((l_t4270 (singleton-state (quote l_range) (d_make_range #f #f #f (lookup (quote l_start) l_s4055) (d_stream_location #f #f #f (lookup (quote l_stream) l_s4055)))))) (let ((l_p4271 l_s4056)) (if l_p4271 (merge-state l_p4271 (if l_d4029 (empty-state) l_t4270)) (if l_d4029 (empty-state) l_t4270)))))) (if l_l4030 (leave-collective l_l4030 l_t4269) l_t4269)))))))))

(define d_token_kind (lambda (l_p4277 l_d4278 l_l4279 l_token) (let ((l_s4276 (state (quote l_token) l_token))) (let ((l_t4282 (let ((l_t4283 (lookup (quote l_kind) (lookup (quote l_token) l_s4276)))) (let ((l_p4284 l_p4277)) (if l_p4284 (merge-state l_p4284 (if l_d4278 (empty-state) l_t4283)) (if l_d4278 (empty-state) l_t4283)))))) (if l_l4279 (leave-collective l_l4279 l_t4282) l_t4282)))))

(define d_token_value (lambda (l_p4288 l_d4289 l_l4290 l_token) (let ((l_s4287 (state (quote l_token) l_token))) (let ((l_t4293 (let ((l_t4294 (lookup (quote l_value) (lookup (quote l_token) l_s4287)))) (let ((l_p4295 l_p4288)) (if l_p4295 (merge-state l_p4295 (if l_d4289 (empty-state) l_t4294)) (if l_d4289 (empty-state) l_t4294)))))) (if l_l4290 (leave-collective l_l4290 l_t4293) l_t4293)))))

(define d_token_range (lambda (l_p4299 l_d4300 l_l4301 l_token) (let ((l_s4298 (state (quote l_token) l_token))) (let ((l_t4304 (let ((l_t4305 (lookup (quote l_range) (lookup (quote l_token) l_s4298)))) (let ((l_p4306 l_p4299)) (if l_p4306 (merge-state l_p4306 (if l_d4300 (empty-state) l_t4305)) (if l_d4300 (empty-state) l_t4305)))))) (if l_l4301 (leave-collective l_l4301 l_t4304) l_t4304)))))

(define d_read_kinded_token (lambda (l_p4310 l_d4311 l_l4312 l_stream l_kind) (let ((l_s4309 (state (quote l_stream) l_stream (quote l_kind) l_kind))) (let ((l_s4313 (merge-state l_s4309 (singleton-state (quote l_token) (d_next_token #f #f #f (lookup (quote l_stream) l_s4309)))))) (if (equal? (d_token_kind #f #f #f (lookup (quote l_token) l_s4313)) (lookup (quote l_kind) l_s4313)) (let ((l_t5389 (let ((l_t5390 (lookup (quote l_token) l_s4313))) (let ((l_p5391 l_p4310)) (if l_p5391 (merge-state l_p5391 (if l_d4311 (empty-state) l_t5390)) (if l_d4311 (empty-state) l_t5390)))))) (if l_l4312 (leave-collective l_l4312 l_t5389) l_t5389)) (d_throw_with_range l_p4310 l_d4311 l_l4312 "Expected $k1 but found $k2 '$v'" (let ((l_s5394 (singleton-state (quote l_k1) (lookup (quote l_kind) l_s4313)))) (let ((l_s5395 (merge-state l_s4313 l_s5394))) (let ((l_s5396 l_s5394)) (let ((l_s5401 (singleton-state (quote l_v) (d_token_value #f #f #f (lookup (quote l_token) l_s5395))))) (let ((l_s5402 (merge-state l_s5395 l_s5401))) (let ((l_s5403 (merge-state (or l_s5396 (empty-state)) l_s5401))) (merge-state (or l_s5403 (empty-state)) (singleton-state (quote l_k2) (d_token_kind #f #f #f (lookup (quote l_token) l_s5402)))))))))) (d_token_range #f #f #f (lookup (quote l_token) l_s4313))))))))

(define d_skip_token (lambda (l_p5421 l_d5422 l_l5423 l_stream) (let ((l_s5420 (state (quote l_stream) l_stream))) (d_next_token l_p5421 #t l_l5423 (lookup (quote l_stream) l_s5420)))))

(define d_read_number_token (lambda (l_p5429 l_d5430 l_l5431 l_stream) (let ((l_s5428 (state (quote l_stream) l_stream))) (let ((l_s5432 (merge-state l_s5428 (let ((l_s5433 (singleton-state (quote l_handle) (d_token_stream_handle #f #f #f (lookup (quote l_stream) l_s5428))))) (let ((l_s5434 (merge-state l_s5428 l_s5433))) (let ((l_s5435 l_s5433)) (let ((l_s5440 (singleton-state (quote l_digits) (d_empty_list)))) (let ((l_s5441 (merge-state l_s5434 l_s5440))) (let ((l_s5442 (merge-state (or l_s5435 (empty-state)) l_s5440))) (let ((l_s5447 (let ((l_s5450 (empty-state))) (let ((l_s5451 l_s5441)) (begin (while (d_numeric (d_peek_next_char #f #f #f (lookup (quote l_handle) l_s5451))) (let ((l_s5452 (singleton-state (quote l_digits) (d_cons (d_next_char #f #f #f (lookup (quote l_handle) l_s5451)) (lookup (quote l_digits) l_s5451))))) (begin (set! l_s5450 (merge-state l_s5450 l_s5452)) (set! l_s5451 (merge-state l_s5451 l_s5452))))) l_s5450))))) (let ((l_s5448 (merge-state l_s5441 l_s5447))) (let ((l_s5449 (merge-state (or l_s5442 (empty-state)) l_s5447))) (if (equal? (d_peek_next_char #f #f #f (lookup (quote l_handle) l_s5448)) #\.) (let ((l_s5473 (singleton-state (quote l_digits) (d_cons (d_next_char #f #f #f (lookup (quote l_handle) l_s5448)) (lookup (quote l_digits) l_s5448))))) (let ((l_s5474 (merge-state l_s5448 l_s5473))) (let ((l_s5475 (merge-state (or l_s5449 (empty-state)) l_s5473))) (let ((l_s5484 (empty-state))) (let ((l_s5485 l_s5474)) (begin (while (d_numeric (d_peek_next_char #f #f #f (lookup (quote l_handle) l_s5485))) (let ((l_s5486 (singleton-state (quote l_digits) (d_cons (d_next_char #f #f #f (lookup (quote l_handle) l_s5485)) (lookup (quote l_digits) l_s5485))))) (begin (set! l_s5484 (merge-state l_s5484 l_s5486)) (set! l_s5485 (merge-state l_s5485 l_s5486))))) (merge-state (or l_s5475 (empty-state)) l_s5484))))))) (or l_s5449 (empty-state))))))))))))))) (let ((l_t5515 (let ((l_t5516 (d_read_num (d_string (d_reverse #f #f #f (lookup (quote l_digits) l_s5432)))))) (let ((l_p5517 l_p5429)) (if l_p5517 (merge-state l_p5517 (if l_d5430 (empty-state) l_t5516)) (if l_d5430 (empty-state) l_t5516)))))) (if l_l5431 (leave-collective l_l5431 l_t5515) l_t5515))))))

(define d_read_string_token (lambda (l_p5521 l_d5522 l_l5523 l_stream) (let ((l_s5520 (state (quote l_stream) l_stream))) (let ((l_s5524 (merge-state l_s5520 (let ((l_s5525 (singleton-state (quote l_handle) (d_token_stream_handle #f #f #f (lookup (quote l_stream) l_s5520))))) (let ((l_s5526 (merge-state l_s5520 l_s5525))) (let ((l_s5527 l_s5525)) (let ((l_s5532 (singleton-state (quote l_location) (d_stream_location #f #f #f (lookup (quote l_stream) l_s5526))))) (let ((l_s5533 (merge-state l_s5526 l_s5532))) (let ((l_s5534 (merge-state (or l_s5527 (empty-state)) l_s5532))) (let ((l_s5539 (singleton-state (quote l_quote) (d_read_char (lookup (quote l_handle) l_s5533))))) (let ((l_s5540 (merge-state l_s5533 l_s5539))) (let ((l_s5541 (merge-state (or l_s5534 (empty-state)) l_s5539))) (let ((l_s5548 (singleton-state (quote l_char) (d_read_char (lookup (quote l_handle) l_s5540))))) (let ((l_s5549 (merge-state l_s5540 l_s5548))) (let ((l_s5550 (merge-state (or l_s5541 (empty-state)) l_s5548))) (let ((l_s5557 (singleton-state (quote l_chars) (d_empty_list)))) (let ((l_s5558 (merge-state l_s5549 l_s5557))) (let ((l_s5559 (merge-state (or l_s5550 (empty-state)) l_s5557))) (let ((l_s5564 (empty-state))) (let ((l_s5565 l_s5558)) (begin (while (d_not_equal (lookup (quote l_char) l_s5565) #\") (let ((l_s5566 (if (equal? (lookup (quote l_char) l_s5565) eof) (d_throw_with_location #f #f #f "String not closed with an end quote." (empty-state) (lookup (quote l_location) l_s5565)) (let ((l_s5585 (singleton-state (quote l_chars) (d_cons (lookup (quote l_char) l_s5565) (lookup (quote l_chars) l_s5565))))) (let ((l_s5586 (merge-state l_s5565 l_s5585))) (let ((l_s5587 l_s5585)) (merge-state (or l_s5587 (empty-state)) (singleton-state (quote l_char) (d_read_char (lookup (quote l_handle) l_s5586)))))))))) (begin (set! l_s5564 (merge-state l_s5564 l_s5566)) (set! l_s5565 (merge-state l_s5565 l_s5566))))) (merge-state (or l_s5559 (empty-state)) l_s5564)))))))))))))))))))))) (let ((l_t5618 (let ((l_t5619 (d_string (d_reverse #f #f #f (lookup (quote l_chars) l_s5524))))) (let ((l_p5620 l_p5521)) (if l_p5620 (merge-state l_p5620 (if l_d5522 (empty-state) l_t5619)) (if l_d5522 (empty-state) l_t5619)))))) (if l_l5523 (leave-collective l_l5523 l_t5618) l_t5618))))))

(define d_read_character_token (lambda (l_p6661 l_d6662 l_l6663 l_stream) (let ((l_s6660 (state (quote l_stream) l_stream))) (let ((l_s6664 (merge-state l_s6660 (let ((l_s6665 (singleton-state (quote l_handle) (d_token_stream_handle #f #f #f (lookup (quote l_stream) l_s6660))))) (let ((l_s6666 (merge-state l_s6660 l_s6665))) (let ((l_s6667 l_s6665)) (let ((l_s6672 (singleton-state (quote l_escape) (d_read_char (lookup (quote l_handle) l_s6666))))) (let ((l_s6673 (merge-state l_s6666 l_s6672))) (let ((l_s6674 (merge-state (or l_s6667 (empty-state)) l_s6672))) (let ((l_s6681 (singleton-state (quote l_char) (d_read_char (lookup (quote l_handle) l_s6673))))) (let ((l_s6682 (merge-state l_s6673 l_s6681))) (let ((l_s6683 (merge-state (or l_s6674 (empty-state)) l_s6681))) (merge-state (or l_s6683 (empty-state)) (singleton-state (quote l_chars) (if (d_alphabetic (lookup (quote l_char) l_s6682)) (let ((l_s6694 (merge-state l_s6682 (let ((l_s6695 (singleton-state (quote l_chars) (d_cons (lookup (quote l_char) l_s6682) (d_empty_list))))) (let ((l_s6696 (merge-state l_s6682 l_s6695))) (let ((l_s6697 l_s6695)) (let ((l_s6706 (empty-state))) (let ((l_s6707 l_s6696)) (begin (while (d_alphabetic (d_peek_char (lookup (quote l_handle) l_s6707))) (let ((l_s6708 (singleton-state (quote l_chars) (d_cons (d_read_char (lookup (quote l_handle) l_s6707)) (lookup (quote l_chars) l_s6707))))) (begin (set! l_s6706 (merge-state l_s6706 l_s6708)) (set! l_s6707 (merge-state l_s6707 l_s6708))))) (merge-state (or l_s6697 (empty-state)) l_s6706)))))))))) (lookup (quote l_chars) l_s6694)) (d_cons (lookup (quote l_char) l_s6682) (d_empty_list))))))))))))))))) (let ((l_t6747 (let ((l_t6748 (d_string (d_reverse #f #f #f (lookup (quote l_chars) l_s6664))))) (let ((l_p6749 l_p6661)) (if l_p6749 (merge-state l_p6749 (if l_d6662 (empty-state) l_t6748)) (if l_d6662 (empty-state) l_t6748)))))) (if l_l6663 (leave-collective l_l6663 l_t6747) l_t6747))))))

(define d_read_identifier_token (lambda (l_p6753 l_d6754 l_l6755 l_stream) (let ((l_s6752 (state (quote l_stream) l_stream))) (let ((l_s6756 (merge-state l_s6752 (let ((l_s6757 (singleton-state (quote l_handle) (d_token_stream_handle #f #f #f (lookup (quote l_stream) l_s6752))))) (let ((l_s6758 (merge-state l_s6752 l_s6757))) (let ((l_s6759 l_s6757)) (merge-state (or l_s6759 (empty-state)) (singleton-state (quote l_first) (d_next_char #f #f #f (lookup (quote l_handle) l_s6758)))))))))) (if (if (d_alphabetic (lookup (quote l_first) l_s6756)) #t (equal? (lookup (quote l_first) l_s6756) #\_)) (let ((l_s6782 (merge-state l_s6756 (let ((l_s6783 (singleton-state (quote l_chars) (d_cons (lookup (quote l_first) l_s6756) (d_empty_list))))) (let ((l_s6784 (merge-state l_s6756 l_s6783))) (let ((l_s6785 l_s6783)) (let ((l_s6794 (singleton-state (quote l_next) (d_peek_char (lookup (quote l_handle) l_s6784))))) (let ((l_s6795 (merge-state l_s6784 l_s6794))) (let ((l_s6796 (merge-state (or l_s6785 (empty-state)) l_s6794))) (let ((l_s6803 (empty-state))) (let ((l_s6804 l_s6795)) (begin (while (if (d_alphabetic (lookup (quote l_next) l_s6804)) #t (if (d_numeric (lookup (quote l_next) l_s6804)) #t (equal? (lookup (quote l_next) l_s6804) #\_))) (let ((l_s6805 (let ((l_s6824 (singleton-state (quote l_chars) (d_cons (d_read_char (lookup (quote l_handle) l_s6804)) (lookup (quote l_chars) l_s6804))))) (let ((l_s6825 (merge-state l_s6804 l_s6824))) (let ((l_s6826 l_s6824)) (merge-state (or l_s6826 (empty-state)) (singleton-state (quote l_next) (d_peek_char (lookup (quote l_handle) l_s6825))))))))) (begin (set! l_s6803 (merge-state l_s6803 l_s6805)) (set! l_s6804 (merge-state l_s6804 l_s6805))))) (merge-state (or l_s6796 (empty-state)) l_s6803))))))))))))) (let ((l_t6853 (let ((l_t6854 (d_string (d_reverse #f #f #f (lookup (quote l_chars) l_s6782))))) (let ((l_p6855 l_p6753)) (if l_p6855 (merge-state l_p6855 (if l_d6754 (empty-state) l_t6854)) (if l_d6754 (empty-state) l_t6854)))))) (if l_l6755 (leave-collective l_l6755 l_t6853) l_t6853))) (let ((l_t6864 (let ((l_t6865 (d_throw (d_format "expected a letter or a '_' asas to start an identifier but found a '$char'" (singleton-state (quote l_char) (lookup (quote l_first) l_s6756)))))) (let ((l_p6866 l_p6753)) (if l_p6866 (merge-state l_p6866 (if l_d6754 (empty-state) l_t6865)) (if l_d6754 (empty-state) l_t6865)))))) (if l_l6755 (leave-collective l_l6755 l_t6864) l_t6864)))))))

(define d_read_operator_token (lambda (l_p6870 l_d6871 l_l6872 l_stream) (let ((l_s6869 (state (quote l_stream) l_stream))) (let ((l_s6873 (merge-state l_s6869 (let ((l_s6874 (singleton-state (quote l_handle) (d_token_stream_handle #f #f #f (lookup (quote l_stream) l_s6869))))) (let ((l_s6875 (merge-state l_s6869 l_s6874))) (let ((l_s6876 l_s6874)) (merge-state (or l_s6876 (empty-state)) (singleton-state (quote l_first) (d_next_char #f #f #f (lookup (quote l_handle) l_s6875)))))))))) (if (d_is_operator_character #f #f #f (lookup (quote l_first) l_s6873)) (let ((l_s6889 (merge-state l_s6873 (let ((l_s6890 (singleton-state (quote l_chars) (d_cons (lookup (quote l_first) l_s6873) (d_empty_list))))) (let ((l_s6891 (merge-state l_s6873 l_s6890))) (let ((l_s6892 l_s6890)) (let ((l_s6901 (singleton-state (quote l_next) (d_peek_char (lookup (quote l_handle) l_s6891))))) (let ((l_s6902 (merge-state l_s6891 l_s6901))) (let ((l_s6903 (merge-state (or l_s6892 (empty-state)) l_s6901))) (let ((l_s6910 (empty-state))) (let ((l_s6911 l_s6902)) (begin (while (d_is_operator_character #f #f #f (lookup (quote l_next) l_s6911)) (let ((l_s6912 (let ((l_s6915 (singleton-state (quote l_chars) (d_cons (d_read_char (lookup (quote l_handle) l_s6911)) (lookup (quote l_chars) l_s6911))))) (let ((l_s6916 (merge-state l_s6911 l_s6915))) (let ((l_s6917 l_s6915)) (merge-state (or l_s6917 (empty-state)) (singleton-state (quote l_next) (d_peek_char (lookup (quote l_handle) l_s6916))))))))) (begin (set! l_s6910 (merge-state l_s6910 l_s6912)) (set! l_s6911 (merge-state l_s6911 l_s6912))))) (merge-state (or l_s6903 (empty-state)) l_s6910))))))))))))) (let ((l_t6944 (let ((l_t6945 (d_string (d_reverse #f #f #f (lookup (quote l_chars) l_s6889))))) (let ((l_p6946 l_p6870)) (if l_p6946 (merge-state l_p6946 (if l_d6871 (empty-state) l_t6945)) (if l_d6871 (empty-state) l_t6945)))))) (if l_l6872 (leave-collective l_l6872 l_t6944) l_t6944))) (let ((l_t6955 (let ((l_t6956 (d_throw (d_format "expected a character to start an operator but found a '$char'" (singleton-state (quote l_char) (lookup (quote l_first) l_s6873)))))) (let ((l_p6957 l_p6870)) (if l_p6957 (merge-state l_p6957 (if l_d6871 (empty-state) l_t6956)) (if l_d6871 (empty-state) l_t6956)))))) (if l_l6872 (leave-collective l_l6872 l_t6955) l_t6955)))))))

(define d_next_char (lambda (l_p6961 l_d6962 l_l6963 l_handle) (let ((l_s6960 (state (quote l_handle) l_handle))) (let ((l_s6964 (merge-state l_s6960 (let ((l_s6965 (d_skip_whitespace #f #f #f (lookup (quote l_handle) l_s6960)))) (let ((l_s6966 (merge-state l_s6960 l_s6965))) (let ((l_s6967 l_s6965)) (let ((l_s6970 (singleton-state (quote l_char) (d_read_char (lookup (quote l_handle) l_s6966))))) (let ((l_s6971 (merge-state l_s6966 l_s6970))) (let ((l_s6972 (merge-state (or l_s6967 (empty-state)) l_s6970))) (let ((l_s6979 (empty-state))) (let ((l_s6980 l_s6971)) (begin (while (equal? (lookup (quote l_char) l_s6980) #\#) (let ((l_s6981 (let ((l_s6988 (d_read_line_rest #f #f #f (lookup (quote l_handle) l_s6980)))) (let ((l_s6989 (merge-state l_s6980 l_s6988))) (let ((l_s6990 l_s6988)) (let ((l_s6993 (d_skip_whitespace #f #f #f (lookup (quote l_handle) l_s6989)))) (let ((l_s6994 (merge-state l_s6989 l_s6993))) (let ((l_s6995 (merge-state (or l_s6990 (empty-state)) l_s6993))) (merge-state (or l_s6995 (empty-state)) (singleton-state (quote l_char) (d_read_char (lookup (quote l_handle) l_s6994)))))))))))) (begin (set! l_s6979 (merge-state l_s6979 l_s6981)) (set! l_s6980 (merge-state l_s6980 l_s6981))))) (merge-state (or l_s6972 (empty-state)) l_s6979))))))))))))) (let ((l_t7014 (let ((l_t7015 (lookup (quote l_char) l_s6964))) (let ((l_p7016 l_p6961)) (if l_p7016 (merge-state l_p7016 (if l_d6962 (empty-state) l_t7015)) (if l_d6962 (empty-state) l_t7015)))))) (if l_l6963 (leave-collective l_l6963 l_t7014) l_t7014))))))

(define d_peek_next_char (lambda (l_p7261 l_d7262 l_l7263 l_handle) (let ((l_s7260 (state (quote l_handle) l_handle))) (let ((l_s7264 (merge-state l_s7260 (let ((l_s7265 (d_skip_whitespace #f #f #f (lookup (quote l_handle) l_s7260)))) (let ((l_s7266 (merge-state l_s7260 l_s7265))) (let ((l_s7267 l_s7265)) (let ((l_s7270 (singleton-state (quote l_char) (d_peek_char (lookup (quote l_handle) l_s7266))))) (let ((l_s7271 (merge-state l_s7266 l_s7270))) (let ((l_s7272 (merge-state (or l_s7267 (empty-state)) l_s7270))) (let ((l_s7279 (empty-state))) (let ((l_s7280 l_s7271)) (begin (while (equal? (lookup (quote l_char) l_s7280) #\#) (let ((l_s7281 (let ((l_s7288 (d_read_line_rest #f #f #f (lookup (quote l_handle) l_s7280)))) (let ((l_s7289 (merge-state l_s7280 l_s7288))) (let ((l_s7290 l_s7288)) (let ((l_s7293 (d_skip_whitespace #f #f #f (lookup (quote l_handle) l_s7289)))) (let ((l_s7294 (merge-state l_s7289 l_s7293))) (let ((l_s7295 (merge-state (or l_s7290 (empty-state)) l_s7293))) (merge-state (or l_s7295 (empty-state)) (singleton-state (quote l_char) (d_peek_char (lookup (quote l_handle) l_s7294)))))))))))) (begin (set! l_s7279 (merge-state l_s7279 l_s7281)) (set! l_s7280 (merge-state l_s7280 l_s7281))))) (merge-state (or l_s7272 (empty-state)) l_s7279))))))))))))) (let ((l_t7314 (let ((l_t7315 (lookup (quote l_char) l_s7264))) (let ((l_p7316 l_p7261)) (if l_p7316 (merge-state l_p7316 (if l_d7262 (empty-state) l_t7315)) (if l_d7262 (empty-state) l_t7315)))))) (if l_l7263 (leave-collective l_l7263 l_t7314) l_t7314))))))

(define d_next_non_whitespace_char (lambda (l_p7320 l_d7321 l_l7322 l_handle) (let ((l_s7319 (state (quote l_handle) l_handle))) (let ((l_s7323 (merge-state l_s7319 (let ((l_s7324 (singleton-state (quote l_char) (d_next_char #f #f #f (lookup (quote l_handle) l_s7319))))) (let ((l_s7325 (merge-state l_s7319 l_s7324))) (let ((l_s7326 l_s7324)) (let ((l_s7331 (empty-state))) (let ((l_s7332 l_s7325)) (begin (while (d_whitespace (lookup (quote l_char) l_s7332)) (let ((l_s7333 (singleton-state (quote l_char) (d_next_char #f #f #f (lookup (quote l_handle) l_s7332))))) (begin (set! l_s7331 (merge-state l_s7331 l_s7333)) (set! l_s7332 (merge-state l_s7332 l_s7333))))) (merge-state (or l_s7326 (empty-state)) l_s7331)))))))))) (let ((l_t7346 (let ((l_t7347 (lookup (quote l_char) l_s7323))) (let ((l_p7348 l_p7320)) (if l_p7348 (merge-state l_p7348 (if l_d7321 (empty-state) l_t7347)) (if l_d7321 (empty-state) l_t7347)))))) (if l_l7322 (leave-collective l_l7322 l_t7346) l_t7346))))))

(define d_skip_whitespace (lambda (l_p7352 l_d7353 l_l7354 l_handle) (let ((l_s7351 (state (quote l_handle) l_handle))) (let ((l_s7355 (merge-state l_s7351 (singleton-state (quote l_char) (d_peek_char (lookup (quote l_handle) l_s7351)))))) (let ((l_s7362 (empty-state))) (let ((l_s7363 l_s7355)) (begin (while (d_whitespace (lookup (quote l_char) l_s7363)) (let ((l_s7364 (let ((l_s7369 (let ((l_t7374 (d_read_char (lookup (quote l_handle) l_s7363)))) (empty-state)))) (let ((l_s7370 (merge-state l_s7363 l_s7369))) (let ((l_s7371 l_s7369)) (merge-state (or l_s7371 (empty-state)) (singleton-state (quote l_char) (d_peek_char (lookup (quote l_handle) l_s7370))))))))) (begin (set! l_s7362 (merge-state l_s7362 l_s7364)) (set! l_s7363 (merge-state l_s7363 l_s7364))))) (let ((l_t7384 (let ((l_t7385 l_s7362)) (or l_p7352 (empty-state))))) (if l_l7354 (leave-collective l_l7354 l_t7384) l_t7384)))))))))

(define d_skip_char (lambda (l_p7390 l_d7391 l_l7392 l_handle) (let ((l_s7389 (state (quote l_handle) l_handle))) (d_next_char l_p7390 #t l_l7392 (lookup (quote l_handle) l_s7389)))))

(define d_read_line_rest (lambda (l_p7398 l_d7399 l_l7400 l_handle) (let ((l_s7397 (state (quote l_handle) l_handle))) (let ((l_s7401 (merge-state l_s7397 (singleton-state (quote l_char) (d_read_char (lookup (quote l_handle) l_s7397)))))) (let ((l_s7408 (empty-state))) (let ((l_s7409 l_s7401)) (begin (while (if (d_not_equal (lookup (quote l_char) l_s7409) #\newline) (d_not_equal (lookup (quote l_char) l_s7409) eof) #f) (let ((l_s7410 (singleton-state (quote l_char) (d_read_char (lookup (quote l_handle) l_s7409))))) (begin (set! l_s7408 (merge-state l_s7408 l_s7410)) (set! l_s7409 (merge-state l_s7409 l_s7410))))) (let ((l_t7431 (let ((l_t7432 l_s7408)) (or l_p7398 (empty-state))))) (if l_l7400 (leave-collective l_l7400 l_t7431) l_t7431)))))))))
